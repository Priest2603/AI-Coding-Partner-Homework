# Intelligent Customer Support System (Homework 2)

Customer support ticket management API built with **Node.js + Express + TypeScript**. It supports **multi-format bulk import** (CSV/JSON/XML), **automatic ticket classification** (category + priority), filtering, and a comprehensive Jest test suite with coverage thresholds.

## Features

- **Ticket CRUD API**: create, list (with filtering), read, update, delete
- **Bulk import**: upload **CSV / JSON / XML** via multipart form-data
- **Validation**: strong input validation using **Zod** (enums, lengths, email format)
- **Auto-classification**: detects **category**, **priority**, **confidence**, and **keywords**
- **Observability**: structured logging via **Winston**
- **Testing & coverage**: Jest + ts-jest with **85% global coverage thresholds**

## Documentation

- API reference (endpoints, schemas, examples): [API_REFERENCE.md](docs/API_REFERENCE.md)
- Architecture overview (components, flows, decisions): [ARCHITECTURE.md](docs/ARCHITECTURE.md)
- QA testing guide (how to run tests, fixtures, manual checklist): [TESTING_GUIDE.md](docs/TESTING_GUIDE.md)

## Architecture (High Level)

```mermaid
flowchart LR
  Client[API Consumer\n(Postman / Tests / UI)] -->|HTTP JSON / multipart| Express[Express App\nsrc/index.ts]

  Express --> Tickets[Ticket Routes\nsrc/routes/tickets.ts]
  Express --> Import[Import Routes\nsrc/routes/import.ts]

  Tickets --> Zod[Zod Schemas\nsrc/types/ticket.ts]
  Tickets --> Classifier[Classification Service\nsrc/services/classificationService.ts]
  Tickets --> Storage[Ticket Storage\n(in-memory)\nsrc/services/ticketStorage.ts]

  Import --> Multer[Multer Upload\n(memory storage)]
  Import --> Parsers[Parsers\nsrc/parsers/*]
  Parsers --> CSV[csv-parse]
  Parsers --> XML[fast-xml-parser]
  Import --> Storage

  Express --> Errors[Error Handler Middleware\nsrc/middleware/errorHandler.ts]
  Express --> Logger[Logger\nsrc/services/logger.ts]
```

## Installation & Setup

### Prerequisites

- Node.js **18+** (Node 20/22 recommended)
- npm (ships with Node)

### Install

From the repository root:

```bash
cd AI-Coding-Partner-Homework/homework-2
npm install
```

### Run locally

- Dev (auto-reload):

```bash
npm run dev
```

- Production build + start:

```bash
npm run build
npm start
```

### Configuration

- `PORT` (optional): defaults to `3000`

Quick health check:

```bash
curl http://localhost:3000/health
```

## How to Run Tests

- Run unit/integration tests with coverage:

```bash
npm test
```

- Watch mode:

```bash
npm run test:watch
```

- Load test script (concurrent requests):

```bash
npm run test:load
```

Notes:
- Coverage output is written to `coverage/`.
- Jest enforces global thresholds (branches/functions/lines/statements) at **85%**.

## Project Structure

```text
homework-2/
  src/
    index.ts                # Express app entrypoint
    routes/                 # HTTP routes (/tickets, /tickets/import)
    parsers/                # CSV/JSON/XML parsing utilities
    services/               # storage, classification, logging
    middleware/             # error handling
    types/                  # zod schemas + shared types
  tests/
    *.test.ts               # Jest test suite
    fixtures/               # sample/invalid import files
    load/                   # load/concurrency script(s)
  postman/                  # Postman collection + environment
  coverage/                 # generated by tests (do not edit)
  package.json
  jest.config.js
  tsconfig.json
```
